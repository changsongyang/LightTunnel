package lighttunnel.common.utils

import org.junit.Test

class CryptoUtilsTest {

    @Test
    fun randomAES128Key() {
        val key = CryptoUtils.randomAES128Key()
        System.err.println(key)
    }

    @Test
    fun randomRSAKeyPair() {
        val keyPair = CryptoUtils.randomRSAKeyPair()
        System.err.println(HexStringUtils.bytesToHexString(keyPair.first))
        System.err.println(HexStringUtils.bytesToHexString(keyPair.second))
    }

    @Test
    fun encryptAES128() {
        try {
            val key128 = "MTsSGZ1aA4wVv2E9"
            val data = CryptoUtils.encryptAES128("hello".toByteArray(), key128.toByteArray())
            val hex = HexStringUtils.bytesToHexString(data)
            System.err.println(hex)
        } catch (e: Exception) {
            e.printStackTrace()
        }
    }

    @Test
    fun decryptAES128() {
        try {
            val key128 = "MTsSGZ1aA4wVv2E9"
            val data = CryptoUtils.decryptAES128(
                HexStringUtils.hexStringToBytes("84CACCC9241CE6CC10E9D959069F3FE4"), key128.toByteArray()
            )
            System.err.println(String(data))
        } catch (e: Exception) {
            e.printStackTrace()
        }
    }

    @Test
    fun encryptRSA() {
        try {
            val pub =
                "30820122300D06092A864886F70D01010105000382010F003082010A028201010091350FA1711A7160FA857A1DCB4209FC0C059DC11B4B1577DD9D623262FBF31834FCA87827AF25E44603E42E3A91D4514309355E1A99A4F70B00B2DF84B33FCC9F6554C7F2C39175973FD50B9E67D3051BC5918597CBE8807F60CE0C63D3A33F65AD9C85B92670A4BE8E564CFB65CDBDD1FC842A9845588F0DCEE82D758717F9FE929FFF9690CFE9BA97FAE3490370A9B3225AB2EB5011E8D5CE4DBBC08EE84522EDE4CEED7BA16EB1163960484AC46C9E31649E7B9A18BF3467AF075D4DA20AE002C2043C24357411B0E0F236720B64BCF0EA0A921012845433C8629C5DA8099D6BA4E205B3E4E56D6149514A65C703F415737263EAA1E53FC52514F64DF8510203010001"
            val data = CryptoUtils.encryptRSA(
                "MTsSGZ1aA4wVv2E9".toByteArray(),
                HexStringUtils.hexStringToBytes(pub)
            )
            System.err.println(HexStringUtils.bytesToHexString(data))
        } catch (e: Exception) {
            e.printStackTrace()
        }
    }

    @Test
    fun decryptRSA() {
        try {
            val pri =
                "308204BE020100300D06092A864886F70D0101010500048204A8308204A4020100028201010091350FA1711A7160FA857A1DCB4209FC0C059DC11B4B1577DD9D623262FBF31834FCA87827AF25E44603E42E3A91D4514309355E1A99A4F70B00B2DF84B33FCC9F6554C7F2C39175973FD50B9E67D3051BC5918597CBE8807F60CE0C63D3A33F65AD9C85B92670A4BE8E564CFB65CDBDD1FC842A9845588F0DCEE82D758717F9FE929FFF9690CFE9BA97FAE3490370A9B3225AB2EB5011E8D5CE4DBBC08EE84522EDE4CEED7BA16EB1163960484AC46C9E31649E7B9A18BF3467AF075D4DA20AE002C2043C24357411B0E0F236720B64BCF0EA0A921012845433C8629C5DA8099D6BA4E205B3E4E56D6149514A65C703F415737263EAA1E53FC52514F64DF8510203010001028201004EDB79149CBED689EB2367D11C5C4DDDD28D8E419BD7E7DDC3BDBFE14B3E36A393CB0E96CA3E651E962370DCE633E2110B8DC9ACC457626E434C6AD7D6521E38BAEBA5E23C6596EE3C688F039350211A6A1D9E4CE5C5F80B28A1E2E479A62AC6B82A53918F9E5F982860565FD23B54435CF17CB9411E8FDC888C302CD7E1B8D3DA9F71FA0FBC6E6127062D09AF34E308D2CC8263D472AC61CD88B38B1E073272D0978EDA98685EA9EE479F7675CBB746BF845010259ABFBCF4B20905F71D6678282CDE1E94C7B2979776ECDE4A9A2251E018ABD3B30CD7787E7519E3A9435386BDE859E1ED1A74374B5CD0C5F0F855D311B95323827D4B87DEC2345142AAE5C102818100C959DE98E4979AA1CFC3287FAEB871647105681AD4C230DAAE09A859A402883BE5FE95F63A8A44E40444559C8576977B4793B508F8AB114ABBB1EB3B50AF3F4AB1CFA7092A0AA8A7BB67FA4584C681AD0F6BE234470C196974A62BF6CCE188C801B4408623F13B977BBFBEF506F301E49205C658270FCCE2365D07DF993FE1A902818100B89E3FCA379EB156B21788EE01606133F7C7ACDF1E5377A5ECB61DAF43CFCDF31AFB61AD1BCAFE928988FA53F7DE1286FE6C9AE30F4B9B067266E79884D46F87424BD50C7FE92592624EB5E252044A74DC51C841CA6EBF334597F3AA2826A4DEAAF33B0E41C82D0AFEFCC073C57FF86790FC0310B03526FCC33442AC2CBD5A690281801AF675E0737BF9B1016958DB0042A2AC9895E8C2EF0AB210168E24851C795A54EB0F94754C918778213A255CB86291166917567EC50DE35AE69784B084B572FC45A350F2E1365C2F59E12A9A74954078344076221A017CC5AA613631EE6DA52B634F07F4EE8B3737A9D29B77A45E963A4D738883F57720308AA71A8ECEAEC74102818100889F3B8FB7576DDF3D8E231C16D2AF3C590A604901553D7F01CCC7ECF2DEEE871099A57008D8514A3A13AF44C27289FD727D06A62FA480C5E59577A02BF455D09FE42476CA95CBE327731E30AD0755DE6348F64C91B521339D35D4F1402350F1234B3A91D36682C6D76A4E359E9B9445784AB72DFB686A40B568904A801564B902818100AA0443520A720682FCD061E5F05EF8AF7175AF58B3F687B61DFD7442F6854E2211DDF5685D43ADE57535658C75C6A28CF5C8A580380512D32EDB2978EEE700F2BF3EF432361332F6BA5941D46F3B688F18E22FFB314FFB203B1379637502AAF898DF41EA5BA2B00D2F0FF993550A7D2C9D6BF993DECD881972A904B3AF61C0C8"
            val data = CryptoUtils.decryptRSA(
                HexStringUtils.hexStringToBytes("1D8ABDFB5BF1F26DC4483B85E25B4162FF4C61F30EFC0CBBADBE13407A19FE05A88A1B5644A4AEEA6C363CD73C09866FDBA191D57A177EE2589F83C4C642C7A39E3F726526B3149C10F60973481E3F5B88404EDB644D3FC1EF6B100069276290993055292F2B0A23A77857F8F7CE45E250769CE7B14601011C53E3BF268E50C43557FC7CCEEAA8B0F1F507E8DD20F89DCCF014423218331FE7943036F0D502649B4D2409C674385E22585E1356AF9FE6134661ABAF1D91FBB92F46FD07462F78C73FD194AF2185A5FC94CD8E9ABBEF84814BC4C4D5D497C2F71F828B5E8DAA492A037B61B731597A3E1E4C6DF81094D3E04DC12AEF57789968C5BD9782B2F41B"),
                HexStringUtils.hexStringToBytes(pri)
            )
            System.err.println(String(data))
        } catch (e: Exception) {
            e.printStackTrace()
        }
    }
}
